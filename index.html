<!DOCTYPE html>
<html lang="English">
<head>

    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Syd SHI YI" />


    
    


<meta name="description" content="A place for trolling and whining">
<meta property="og:type" content="website">
<meta property="og:title" content="Syd">
<meta property="og:url" content="http://www.yi3hi.com/index.html">
<meta property="og:site_name" content="Syd">
<meta property="og:description" content="A place for trolling and whining">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Syd">
<meta name="twitter:description" content="A place for trolling and whining">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Syd" type="application/atom+xml">



    <link rel="shortcut icon" href="/syd.jpg">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Syd</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->






</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/syd.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Syd SHI YI</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:shiyi2008@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Geometry-basics/">Geometry basics</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Syd SHI YI</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/syd.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Syd SHI YI</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:shiyi2008@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-Delaunay-Triangle-and-subdivision-under-opencv" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/10/Delaunay-Triangle-and-subdivision-under-opencv/" class="article-date">
      <time datetime="2017-05-10T06:19:05.000Z" itemprop="datePublished">2017-05-10</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/10/Delaunay-Triangle-and-subdivision-under-opencv/">Delaunay Trianglulation and subdivision under opencv</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="Delaunay-triangulation"><a href="#Delaunay-triangulation" class="headerlink" title="Delaunay triangulation"></a>Delaunay triangulation</h3><h5 id="I-Introduction"><a href="#I-Introduction" class="headerlink" title="I.Introduction"></a>I.Introduction</h5><p>A Delaunay triangulation for a set P of points in a plane is a triangulation DT(P) such that no point in P is inside any triangle in DT(P).<br>i.e. it’s required to use every point in the set to form triangles which do not cross each other.</p>
<p><img src="/images/pasted-3.png" alt="upload successful"></p>
<p>Delaunay triangulations maximize the minimum angle of all triangles in the triangulation; they tend to avoid sliver triangles which means those with angle larger than 180 degree. </p>
<h5 id="II-Properties"><a href="#II-Properties" class="headerlink" title="II.Properties"></a>II.Properties</h5><p>Let n be the number of points and d the number of dimensions.(unfinished)<br>1.</p>
<h5 id="III-Visual-Delaunay-generation"><a href="#III-Visual-Delaunay-generation" class="headerlink" title="III.Visual Delaunay generation"></a>III.Visual Delaunay generation</h5><p>Here are Triangles ABD and BCD which share the same edge BD:</p>
<p><img src="/images/pasted-4.png" alt="upload successful"></p>
<p>It has angles larger than 180 degree. It violate the rule of Delaunay triangulation. To show if we have link the triangles as required, we can draw a circle using 3 of the points on the same triangle like in here ABD, we found the other point is inside the circle.</p>
<p><img src="/images/pasted-5.png" alt="upload successful"></p>
<p>On the other hand, now the points meet the requirement. </p>
<p><img src="/images/pasted-6.png" alt="upload successful"></p>
<p>As you can see, if two triangles do not meet the Delaunay condition, switching the common edge BD for the common edge AC produces two triangles that do meet the Delaunay condition</p>
<h6 id="Algorithms"><a href="#Algorithms" class="headerlink" title="Algorithms"></a>Algorithms</h6><p>Many algorithms for computing Delaunay triangulations rely on fast operations for detecting when a point is within a triangle’s circumcircle and an efficient data structure for storing triangles and edges. In two dimensions, one way to detect if point D lies in the circumcircle of A, B, C is to evaluate the</p>
<hr>
<h6 id="concern-type-and-function-in-opencv"><a href="#concern-type-and-function-in-opencv" class="headerlink" title="concern type and function in opencv"></a>concern type and function in opencv</h6><p>Rect:<br>typedef struct<br>{<br>int x; /<em> left or right x </em>/<br>int y; /<em> upper or lower y </em>/<br>int width; /<em> width </em>/<br>int height; /<em> height </em>/<br>}<br>CvRect;</p>
<p><img src="/images/pasted-7.png" alt="upload successful"></p>
<p>But here we use method from the opencv2 library which is named Subdiv2D. In this case, the rect represents by (x in the lower left corner, y in the lower left corner, x in the upper right corner, y in the upper right corner).</p>
<p>The rectangle stands for the area in which we want  to generate delaunay triangles and split into sub divided space.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> cv2</div><div class="line"></div><div class="line">fixed_height = <span class="number">300</span>;fixed_width = <span class="number">300</span></div><div class="line">rect = (<span class="number">0</span>,<span class="number">0</span>,fixed_width,fixed_height)</div><div class="line">sub = cv2.Subdiv2D(rect)</div><div class="line">list = [(<span class="number">10</span>,<span class="number">10</span>),(<span class="number">4</span>,<span class="number">5</span>),(<span class="number">8</span>,<span class="number">8</span>),(<span class="number">100</span>,<span class="number">123</span>),(<span class="number">288</span>,<span class="number">222</span>)]</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list:</div><div class="line">	sub.insert((i[<span class="number">0</span>], i[<span class="number">1</span>]))</div><div class="line"></div><div class="line">triangleList = sub.getTriangleList()</div><div class="line"><span class="keyword">print</span> triangleList</div></pre></td></tr></table></figure>
<p>Here we yield the result</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[[ <span class="number">900.</span>    <span class="number">0.</span>    <span class="number">0.</span>  <span class="number">900.</span>  <span class="number">288.</span>  <span class="number">222.</span>]</div><div class="line"> [   <span class="number">0.</span>  <span class="number">900.</span>  <span class="number">900.</span>    <span class="number">0.</span> <span class="number">-900.</span> <span class="number">-900.</span>]</div><div class="line"> [   <span class="number">0.</span>  <span class="number">900.</span> <span class="number">-900.</span> <span class="number">-900.</span>    <span class="number">4.</span>    <span class="number">5.</span>]</div><div class="line"> [<span class="number">-900.</span> <span class="number">-900.</span>  <span class="number">900.</span>    <span class="number">0.</span>    <span class="number">4.</span>    <span class="number">5.</span>]</div><div class="line"> [ <span class="number">900.</span>    <span class="number">0.</span>   <span class="number">10.</span>   <span class="number">10.</span>    <span class="number">8.</span>    <span class="number">8.</span>]</div><div class="line"> [  <span class="number">10.</span>   <span class="number">10.</span>  <span class="number">900.</span>    <span class="number">0.</span>  <span class="number">288.</span>  <span class="number">222.</span>]</div><div class="line"> [   <span class="number">4.</span>    <span class="number">5.</span>  <span class="number">100.</span>  <span class="number">123.</span>    <span class="number">0.</span>  <span class="number">900.</span>]</div><div class="line"> [ <span class="number">100.</span>  <span class="number">123.</span>    <span class="number">4.</span>    <span class="number">5.</span>   <span class="number">10.</span>   <span class="number">10.</span>]</div><div class="line"> [   <span class="number">4.</span>    <span class="number">5.</span>  <span class="number">900.</span>    <span class="number">0.</span>    <span class="number">8.</span>    <span class="number">8.</span>]</div><div class="line"> [  <span class="number">10.</span>   <span class="number">10.</span>    <span class="number">4.</span>    <span class="number">5.</span>    <span class="number">8.</span>    <span class="number">8.</span>]</div><div class="line"> [   <span class="number">0.</span>  <span class="number">900.</span>  <span class="number">100.</span>  <span class="number">123.</span>  <span class="number">288.</span>  <span class="number">222.</span>]</div><div class="line"> [ <span class="number">100.</span>  <span class="number">123.</span>   <span class="number">10.</span>   <span class="number">10.</span>  <span class="number">288.</span>  <span class="number">222.</span>]]</div></pre></td></tr></table></figure>
<p> Every row includes three point forming a triangle<br> [x1 y1 x2 y2 x3 y3]. The incredible large number 900 is generated to represent the infinite edge of the rectangular area whcih is always three times the x,y values of far reaching point of our rectangle. </p>
<p> If we draw it now it would go against our requirement that split the rectangular area into pieces accordng to features.</p>
<p> <a href="http://i.stack.imgur.com/oBi2p.jpg" target="_blank" rel="external">http://i.stack.imgur.com/oBi2p.jpg</a><br><img src="/images/pasted-8.png" alt="upload successful"></p>
<p>Instead of using the ready-made points we should add a restriction to get rid of out of bound points.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">rectContains</span><span class="params">(rect, point)</span> :</span></div><div class="line">    <span class="keyword">if</span> point[<span class="number">0</span>] &lt; rect[<span class="number">0</span>] <span class="keyword">or</span> point[<span class="number">1</span>] &lt; rect[<span class="number">1</span>] <span class="keyword">or</span> point[<span class="number">0</span>] &gt; rect[<span class="number">2</span>] <span class="keyword">or</span> point[<span class="number">1</span>] &gt; rect[<span class="number">3</span>]:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculateDelaunayTriangles</span><span class="params">(rect, points)</span>:</span></div><div class="line">    <span class="comment"># Create subdiv</span></div><div class="line">    subdiv = cv2.Subdiv2D(rect)</div><div class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> points:</div><div class="line">        subdiv.insert((p[<span class="number">0</span>], p[<span class="number">1</span>]))</div><div class="line">    <span class="comment"># List of triangles. Each triangle is a list of 3 points ( 6 numbers )</span></div><div class="line">    triangleList = subdiv.getTriangleList()</div><div class="line">    <span class="comment"># Find the indices of triangles in the points array</span></div><div class="line">    <span class="keyword">print</span> triangleList </div><div class="line">delaunayTri = []</div><div class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> triangleList:</div><div class="line">        pt = []</div><div class="line">        pt.append((t[<span class="number">0</span>], t[<span class="number">1</span>]))</div><div class="line">        pt.append((t[<span class="number">2</span>], t[<span class="number">3</span>]))</div><div class="line">        pt.append((t[<span class="number">4</span>], t[<span class="number">5</span>]))</div><div class="line">        pt1 = (t[<span class="number">0</span>], t[<span class="number">1</span>])</div><div class="line">        pt2 = (t[<span class="number">2</span>], t[<span class="number">3</span>])</div><div class="line">        pt3 = (t[<span class="number">4</span>], t[<span class="number">5</span>])</div><div class="line"><span class="keyword">for</span> point <span class="keyword">in</span> points:</div><div class="line">	<span class="comment">#make sure they are in the area</span></div><div class="line">	<span class="keyword">if</span> rectContains(rect, pt1) <span class="keyword">and</span> rectContains(rect, pt2) <span class="keyword">and</span> rectContains(rect, pt3):</div><div class="line">    	ind = []</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="number">3</span>):</div><div class="line">        	<span class="keyword">for</span> k <span class="keyword">in</span> xrange(<span class="number">0</span>, len(points)):</div><div class="line">                    <span class="comment"># make sure they are all of the key points in one pic</span></div><div class="line">                    <span class="keyword">if</span>(abs(pt[j][<span class="number">0</span>] - points[k][<span class="number">0</span>]) &lt; <span class="number">1.0</span> <span class="keyword">and</span> abs(pt[j][<span class="number">1</span>] - points[k][<span class="number">1</span>]) &lt; <span class="number">1.0</span>):</div><div class="line">                        ind.append(k)</div><div class="line">            <span class="keyword">if</span> len(ind) == <span class="number">3</span>:</div><div class="line">                delaunayTri.append((ind[<span class="number">0</span>], ind[<span class="number">1</span>], ind[<span class="number">2</span>]))</div><div class="line">	<span class="keyword">return</span> delaunayTri</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/04/25/hello-world/" class="article-date">
      <time datetime="2017-04-25T08:10:57.000Z" itemprop="datePublished">2017-04-25</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/25/hello-world/">Average Face Generation</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>After days of trying, I finally made it work! The program is based on Python and Opencv, a library which is used in the area of computer vision.</p>
<h3 id="Face-Landmark-detection"><a href="#Face-Landmark-detection" class="headerlink" title="Face Landmark detection"></a>Face Landmark detection</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> cv2</div><div class="line"><span class="keyword">import</span> dlib</div><div class="line">PREDICTOR_PATH = <span class="string">"/shape_predictor_68_face_landmarks.dat"</span></div><div class="line"><span class="comment">#TensorFace/openface/models/dlib/shape_predictor_68_face_landmarks.dat</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">detectFaceKeyPoint</span><span class="params">(img)</span>:</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">NoFaces</span><span class="params">(Exception)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line">    rects = detector(img,<span class="number">1</span>)</div><div class="line">    <span class="keyword">if</span> len(rects) &gt; <span class="number">1</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"multiple faces detected!"</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">elif</span> len(rects) == <span class="number">0</span>:</div><div class="line">        <span class="keyword">raise</span> NoFaces</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">elif</span> len(rects) == <span class="number">1</span>:</div><div class="line">        landmarks = np.array([[p.x,p.y] <span class="keyword">for</span> p <span class="keyword">in</span> predictor(img,rects[<span class="number">0</span>]).parts()])</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Face-Landmarks-detection"><a href="#Face-Landmarks-detection" class="headerlink" title="Face Landmarks detection"></a>Face Landmarks detection</h3><p>We need to align all key elements on the face  in order to generate a clear average face image. </p>
<p>First of all we need to make pictures into the same size, furthermore, making all of the heads into the same scale. As a matter of fact, people have approximately equavelant distance between their two eye corners.</p>
<p>To find the eye corner on every face, we can use the previous found face landmarks.<br>Left eye corner is point Number 36, right corner is 45.</p>
<p><img src="/images/sblc.jpg" width="50%" height="50%"></p>
<h3 id="Naive-Face-Averaging"><a href="#Naive-Face-Averaging" class="headerlink" title="Naïve Face Averaging"></a>Naïve Face Averaging</h3><p>It’s called naïve face averaging. We align the eye corners of our frontal face image before we take average on the grey scale on every pixels. Be careful to make all grey value between 0-1.</p>
<p><img src="/images/naive_avg_face.jpg" alt="naive" title="naive face averaging result"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">forceAvg</span><span class="params">(totalImagesArray)</span>:</span></div><div class="line">    sumimg=np.zeros((fixed_width,fixed_height))</div><div class="line">    totalImagesArray = np.array(totalImagesArray)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(totalImagesArray)):</div><div class="line">        sumimg = sumimg + totalImagesArray[i]</div><div class="line">    <span class="comment">#sumimg = sum (totalImagesArray)</span></div><div class="line">    <span class="comment">#print np.shape(sumimg),sumimg</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"sum"</span>, sumimg,<span class="string">"shape"</span>,np.shape(sumimg)</div><div class="line">    sumimg = sumimg / len(totalImagesArray)/<span class="number">256</span></div><div class="line">    <span class="comment">#sumimg = sumimg.astype(int)</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"avg"</span>, sumimg,<span class="string">"shape"</span>,np.shape(sumimg)</div><div class="line">    cv2.imshow(<span class="string">"naive"</span>,sumimg)</div><div class="line">    cv2.waitKey(<span class="number">0</span>)</div></pre></td></tr></table></figure>
<p>The result is far from pretty, the reason of which is different faces have variant distance among the key points like nose, mouth, eyes. Some people have large face size while others are more pointy.</p>
<p>To deal with the problem, I have to break the face image into pieces and align all pieces  individually to get a ideal result.</p>
<p>A concept called Delaunay Triangle is introduced to seperate all features. </p>
<h3 id="Planar-Subdivisions-Delaunay-Triangle"><a href="#Planar-Subdivisions-Delaunay-Triangle" class="headerlink" title="Planar Subdivisions: Delaunay Triangle"></a>Planar Subdivisions: Delaunay Triangle</h3><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Detail of Delaunay Triangle</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-My-New-Post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/04/25/My-New-Post/" class="article-date">
      <time datetime="2017-04-25T07:50:00.000Z" itemprop="datePublished">2017-04-25</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/25/My-New-Post/">Similarity Transformation in Geometry</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Similarity-Transformation"><a href="#Similarity-Transformation" class="headerlink" title="Similarity Transformation"></a>Similarity Transformation</h2><p>It’s high school geometry time. Nonetheless, I will do it here again because it’s quite important in the field of computer vision and graphics as we will see in my project of Face averaging.</p>
<p>In the same dimension either 3D or 2D</p>
<p>x2= λ[R|T] x1 </p>
<p><img src="/images/pasted-0.png" alt="upload successful"></p>
<p><img src="/images/pasted-1.png" alt="upload successful"></p>
<p>We can now prove it easily</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Computer-Vision/">Computer Vision</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Geometry-basics/">Geometry basics</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2018 Syd SHI YI
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>